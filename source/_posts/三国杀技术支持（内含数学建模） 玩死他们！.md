---
title: 三国杀技术支持（内含数学建模） 玩死他们！
date: 2015/4/3 13:48:25  # 文章发表时间
tags:
- 策划
categories: Game # 分类
thumbnail: https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1530324362&di=11a021ad2e8656d5aee56500e64c9494&imgtype=jpg&er=1&src=http%3A%2F%2Fimg.zcool.cn%2Fcommunity%2F015aa4554922960000019ae939a83e.jpg%403000w_1l_2o_100sh.jpg # 略缩图
layout: post
lede: ""
featured: true
---

### 三国杀牌种分类，

三国杀一共有108张，其中30张杀（21张黑杀，9张红杀，70%黑）、15闪（全红）、8桃（全红）、6过河拆桥、5顺手牵羊、4无中生有、3南蛮入侵、3决斗、3乐不思蜀、3无懈可击、2闪电、2五谷丰登、2借刀杀人、1万箭齐发、1桃园结义；装备共20件（60%为黑色），其中+1/-1马各3匹，11把武器（诸葛连弩2把，其他各1）、3防具（2八卦阵、1仁王盾）

### 一些基本情况的概率判定：

#### 1.仁王盾和八卦盾，选哪个比较好？

这个问题是因人因形式而异的。一般情况下，黑杀有70%，而八卦判定概率为50%（红黑牌各54张），所以仁王盾的防御力比八卦盾高一点，但有几种情况下要特殊对待的。

a) 如果你选择的人物是郭嘉，那就选择八卦盾吧，凡是判定的牌都归你所有，也就是说当你有了八卦盾，别人打你只是给你送牌。这时候会有一种情况比较有意思，你的队友装备了连弩，然后让他攻击你，当你判定失败并且扣血摸牌后，你可以将杀再给队友，呵呵，有点变态了……

b) 如果有司马懿在场，要考虑下他是否和你是队友，如果是的话，可以考虑用八卦，如果不是的话，八卦就变成垃圾了。

c) 如果有关羽在场，并且不是队友的话，要注意了。关羽有54张红色的牌作为杀，还有21张黑色的杀，对于这号人物，他有72%的红杀，你的仁王盾还是考虑换成八卦吧。

d) 如果有赵云在场，并且不是队友的话，也要注意了。赵云有45张杀（24张红杀，其中15张红闪），红色杀的概率为53.3%，仁王盾就不太好用了。

e) 最后要注意一点，就是仁王盾是没有几率的，当关羽赵云杀你的时候，基本上都会出红杀，所以从实践角度来说，碰到这两个人，仁王盾就是一个摆设。

#### 2.被闪电劈中的概率是多少？

呵呵，碰到司马懿在场，要不就相当于你头上顶了避雷针，要不就相当于你就是避雷针，基本没有概率。在一般情况下，黑桃2到黑桃9之间的牌，一共有17张（其中5张杀，4张武器，1张防具，1匹+1马，6条锦囊），几率为15.74%，从数学期望角度来说，也就是摸6张牌，其中有一张就是，换句话说，基本上6轮判定里面就会出现一个避雷针。实际游戏时，考虑到武器、防具、马基本都会被装备掉，而不出现在牌堆里，所以其概率会进一步降低到10.2%。

#### 3.被乐不思蜀的概率是多少？

108张牌中共有27张红桃，其中1张武器，1匹+1马，1匹-1马是红桃，逃脱乐不思蜀的概率是25%，但在实际游戏中，武器、马会被装备掉，所以逃脱的几率会降低到22.2%。

#### 4.当手上有杀有闪的时候，应该留什么牌比较容易不掉血？

这个也是要视场上情况而定的，

a) 如果有盾装备，那就选杀，废话……^-^，呵呵，很多人都会忘掉自己的装备。

b) 如果是甄姬，就选黑杀，黑杀既可以作杀，也可作闪。同理，如果是关羽，就留闪，所有的闪都是红的，都可以作为杀。

c) 对于其他一般人来说，就要考虑场上的位置，和你的角色。如果你是主公，留闪吧，大家都会打你的。如果你的边上都是敌人，那就留闪吧。除了这两种情况外，还要考虑场上是否有曹操，这小子忒恐怖了，3张南蛮入侵和1张万箭齐发，会被他扩散成6张南蛮入侵和2张万箭齐发，而南蛮入侵的几率是75%，如果手头没有无懈可击，那就考虑拿杀吧，免得被AOE死。

### 各个人物的特色分析，

#### 爆发力角色篇，

#### 1.黄月英

爆发力惊人的选手。在讨论爆发力之前，这里先做一个申明，这里的爆发力都是开篇爆发力，后期的爆发力个人觉得意义不大，而且情况复杂，没法子做一个结论。黄月英的爆发力是个人感觉最大的，还是用数字说话，锦囊一共有35条，其中3条可能是不能使用的（1桃园，2借刀），这里假设都能使用。在这35条锦囊中，有4个无中生有（可以换3张），5个顺手牵羊、2个五谷丰登（可以换2张），其余的锦囊可以换1张。对于黄月英来说，1条锦囊牌就等效于4/35*3+7/35*2+24/35*1=1.43张牌。在开局后轮到黄月英的时候，手牌将有6张，用排列组合进行计算得到如下结论，

a) 0张锦囊的概率为8.9%

b) 1张锦囊的概率为27.5%

c) 2张锦囊的概率为33.8%

d) 3张锦囊的概率为21.3%

e) 4张锦囊的概率为7.2%

f) 5张锦囊的概率为1.2%

g) 6张锦囊的概率为0.85%

酱紫，我们可以得到黄月英实际手牌数量增加的数学期望值，

1*0.275+2*0.338+3*0.213+4*0.072+5*0.012+6*0.0085=1.913

考虑到每张锦囊等效于1.43张牌，所以黄月英的手牌数应为1.913*1.43=2.74，将近3张牌。这里我们可以定义黄月英的爆发力为2.74++，这里的++蕴含了两个意思，

1) 爆发力的瞬间最大值会很大，如果看到黄月英手里有将近20牌，那也别震惊，那个是完全有可能的。

2) 这些爆牌过程中使用掉的锦囊将会造成的破坏力也是不容忽视的，在黄月英只是把所有的锦囊都用掉后，经常会看到受伤的主公只有很少的手牌，而且被乐了……

附带说下主公碰到黄月英的打法，在这里我碰到很多主公上来就装备武器砍黄月几刀，想消耗黄月英的手牌，或者至少给予警告，其实这是错误的打法。至少首轮千万不要装备武器，不要随便打击任何人，酱紫轮到黄月英出手的时候，可以通过抑制借刀杀人和桃园结义锦囊来进一步抑制黄月英爆发的几率。

#### 2.甄姬

全程爆发力选手。这个比较容易计算，108张牌里面有红黑各一半，也就是说每次判定成功的几率是50%，这里也做一个数学期望，

1*0.5+1*0.52+1*0.53+1*0.54+1*0.55…+……，可以得到近似于1，同样的定义甄姬的爆发力为1+，这里+蕴含了一个意思，就是可能手牌会RP爆发得到很多，也可能被司马懿改判定后拿到更多。

PS：81楼Crosis补充：如果牌模型不是无限，而是108张来计算，期望是0.98112~

#### 3.黄盖

前期爆发力选手。这个就更容易计算了，上手手牌4张，摸2张，自损3点血摸6张，总共可以有12张牌，无中生有几率比较低，这里忽略了。爆桃的几率是7.4%，爆桃的话相当于多一张牌，所以爆牌的数学期望是2*0.926+3*0.074=2.074，一共是3点血，所以总共为6.22。因为黄盖的牌是基本确定的，总共也就12张，基本不会多，12张牌能做的事情就比较有限了，而且万一没有做成，下一个回合就基本上消失了。根据1血换2牌的原则，这里可以定义黄盖的爆发力是0.22，但是因为爆发力比较稳定，可以用12张牌来爆连弩，所以也是受到玩家喜爱的角色。这里也顺便说下主公碰到黄盖的打法，当然和处理黄月英是相反的，要尽量扣去黄盖的血量，使得黄盖失去爆发的能力。

#### 4.陆逊

后期爆发力选手。陆逊属于后期爆发型选手，这类人物比较适合当内奸。连营的技能能够使得他在后期单挑主公。连营的爆发概率最大为所有的锦囊，杀，桃都能够使用，这里简单的说下最大，最小几率定义，

1) 最大几率：杀（有连弩），桃（自己损血），顺手牵羊，桃园结义，闪电（会伤到自己），借刀杀人，决斗（会伤到自己），南蛮入侵（伤到队友），万箭齐发（伤到队友），其余锦囊和装备，只有闪和无懈可击不能使用，爆发概率为83.3%

2) 最小几率：37张锦囊和装备一定可以使用，概率为34.4%

可见陆逊的后期爆发几率是不稳定的，要取决于场上的形式。由于他是后期爆发选手，而且爆发概率不稳定，这里不做爆发力指标比较。

#### 武将篇

#### 5.关羽

杀伤型选手。108张牌中，一半红色为杀，外加黑杀21张，总杀数量可达75张杀，可以说基本上手上不会没有杀。

#### 6.赵云

攻防兼备型选手。45张杀/闪，基本上什么觉得都可以胜任。

#### 7.张飞

杀伤力恐怖型选手，再有了丈八长矛，基本上无敌了。

#### 8.吕布

伤害型选手，基本上一出手就是掉血。

### 其他篇

#### 9.大乔

封盖型选手。27张方块，排列组合结果显示只有17%的概率手头一张方块都没有，83%的概率至少可以封掉1个人。再配合司马懿对于对手来说简直是噩梦……

#### 10.华佗

支援型选手。这个人物就不分析了，不出牌时50%是桃，出牌时，100%是桃，简直是牛皮糖啊。

#### 11.甘宁

拆牌型选手。54张黑色花色作为过河拆桥，外加1张红色的过河拆桥，基本上50%的过河拆桥，想不拆也难啊。

再有的其他人物基本上没有啥概率问题，在这里就不讨论了

### 很强大~~~

## 还有更强大的~~

摘要：

本文计算了三国杀中一些有趣的概率结果，包括：甄姬洛神的期望为1，与周瑜确定的1张相等，如果只比较洛神和英姿两个技能，前者是占优的。黄月英的期望值 并不像想象的那么高，仅为0.798。黄盖的初始平均手牌大约为15张，周泰可能性最大的死亡时间是第5次判定，计算平均值得，周泰的平均死亡时间是 5.43。

简介：

今天概率论课上，老师讲到几何分布时一时找不到好的例子，站在讲台上发楞，而我却沉浸在了一段美好的回忆之中。那是灵山脚下的一个月黑风高的夜晚， 我作为甄姬独斗主公，就在阴谋已败，满血主公看着红血的我抚掌而笑的时候，我发动了洛神，于是牌局上出现了如下序列：黑的，黑的，黑的，黑的，黑的……主 公在一声高过一声的惊呼中含恨而终。带着对甄姬的景仰，我尝试着计算了一下甄姬洛神的期望，发现结果竟然与预想的不一样，于是我又对其他RP型英雄进行了 分析，然后就有了这篇水文。

#### 1.甄姬与周瑜的比较

甄姬 薄幸的美人

洛神：回合开始阶段,可进行主动判定,若判定结果为黑色花色,视为判定成功,则将该判定牌收归手牌,并可以继续判定;若结果为红色花色,视为判定失败,技能终止.可以不断的判定直到不愿意继续或判定的结果变为红色为止.

周瑜 大都督

英姿：摸牌阶段摸三张牌

公瑾的技能一目了然，多摸一张牌，而甄姬就要罗嗦的多，概括起来就是除了本来那两张以外，还可以一直摸直到摸到红的为止。我们见过一直被红牌憋死的甄姬，也见过黑牌如雨犹如神助的甄姬。为了搞清楚甄姬的技能到底有多大价值，我们来计算一下甄姬额外摸牌数量的期望。

由概率论的知识可以知道，甄姬摸牌张数X是服从几何分布的离散随机变量，其中参数p为1/2。用a表示甄姬额外摸牌数量的期望，则有

这个数列的求和很简单

这说明甄姬洛神的期望为1，与周瑜确定的1张相等（之前我觉得甄姬的期望会小一些），单从期望值来看，两者没有什么区别。但是考虑到三国杀特有的性质，尤其是诸葛连弩等设备的存在性，牌多的时候威力增加得非常之快，玩家存在着一种风险追求的心理，于是有

性质1. 一般情况下，手牌的效用函数u关于手牌张数x是单调递增的凸函数。

用凸函数的性质我们不难证明，甄姬的技能造成的手牌效用大于周瑜的效用，也就是说，一般情况下，如果只比较洛神和英姿两个技能，前者是占优的。

#### 2. 更加招恨的月英姐

黄月英 归隐的侠女

集智：当她使用一张锦囊牌后，立即从牌堆顶摸一张牌加入手牌。

相信大家都有看着黄月英打单机看到睡着的经历，有了上面的结果，我们可以也尝试着计算一下黄月英的期望。由于锦囊里无中生有是非常引人注目的，我们将这个问题单独拿出来讨论。首先，为了简化计算，我们做如下假设：

假设1. 摸牌的过程是无放回抽签模型。这就是说，任何时候，从牌堆上方摸到某一种牌*的可能性p*就是这种 牌的张数在总张数里占的比例。这不仅是对于自己摸牌的阶段来说，也忽略了别人手中有你要的牌的可能。在甄姬的讨论中，我们已经用到了这一假设。这一假设引 起的误差是很小的。事实上，计算所得的期望一般很小，在1 左右，所以摸到很多张同种牌的概率很小，与我们的假设符合。

我们首先讨论无中生有对于一般玩家的影响。

用p*表示某次摸牌摸到无中生有的概率，有p*=a*/s, a*是无中生有的张数，s是总张数，在某次无中生有摸到的两张牌中至少有一张无中生有的概率是1-(1-p*)×(1-p*)，由于p*很小，尽似取为 2p*。实际情况a*=4,s=109,p*=0.037. 定义n次无中生有的牌中还有无中生有的情况为n+1阶无中生有，于是从上面的推理中我们得到：

性质2. 高阶无中生有可以忽略。

下面我们开始计算黄月英附加摸牌张数的期望a。在这里也要做一个假设，黄月英会将所有能用掉的锦囊用掉，同时忽略所有五谷丰登的影响（太崩溃了）。首先计 算使用一张锦囊后集智带来的额外张数b。用p表示黄月英下一张摸到非延时锦囊的概率（不包括无中生有）。根据类似几何分布的性质，我们可以得到关系：

b=1+p×b+p*×(3+3b)

解出b得：

b=(1+3p*)/(1-p-3p*)

游戏中，p=18/109=0.165. 按计算器得b=1.53. 由此我们可以开始计算a.（这是一个综合考虑一般锦囊和无中生有的浩大工程...）

a=p×p×2b+2p×b+p*×p*×2(2+b)+2p*×(2+b)-2p×p*(2+2b)

=0.798

计算结果令人惊讶，黄月英的期望值并不像想象的那么高，仅为0.798！相比之下，还不如周瑜和貂蝉的确定1张，甄姬的平均1张。关于这个问题，我们可以通过性质1给出解释。从b>1可以发现，黄月英一旦摸到一张锦囊，潜力是很足的，而且黄月英在第一轮六张手牌时是极其恐怖的。黄月英用较低的平均值换取了更高的风险，也就是爆发力。

#### 3. 公瑾，请鞭策我！

在三国杀游戏中，总有一些恶趣味的人对于某暴力英雄有特别的喜爱。

黄盖 轻身为国

苦肉：出牌阶段，可主动减一点体力，从牌堆两张牌。在自己回合可以多次使用该技能。

有了之前的分析，有关黄盖的计算就简单多了。先做如下假设：

假设2. （暴力黄盖假设）所考虑的黄盖会在任何有可能时将自己变成一滴血的状态。

于是有推论

推论1. 暴力黄盖的所有桃和桃园结义等价于无中生有。

此时摸到“无中生有”的概率p*=13/109=0.119. 忽略黄盖同时摸到三张“无中生有”的可能，忽略高阶“无中生有”，则暴力黄盖在第一回合未受打击的条件下可以获得的手牌平均数近似为：

a=4+2+(4-1)×2+12p*×(1-p*)^11×2+(12选2)p*^2×(1-p*)^10×4

=12+1.766

计算过程中发现，由于手中初始张数很多，p*也不是很小，高阶“无中生有”产生的影响并不能忽略，所以a只是黄盖手牌的一个下界，综合各方面因素给出估算，黄盖的初始平均手牌大约为15张！试想一下，这样的一个人坐在主公的下家高喊“苍天已死，黄天当立”，对于主公是多大的威胁。（以后大家不要再鄙视暴力黄盖了...）

#### 4. 信春哥者得永生

啥都不说了。

周泰 历战之躯

不屈：任何时候，当你的体力被扣减到0或者更低时，每扣减一点体力：从牌堆上方亮出一张牌放在你的角色牌上，若该牌的点数与你角色牌上已有的任何一张牌都不同，你就不会死去，此时机视同濒死状态。

史上最恶心的小强，我曾作为黄盖手持连弩近十张杀奔向主公，被下家忠臣周泰半路截住，硬抗所有杀而屹立不倒，最后被其一刀砍翻。从此，周泰到底能活多久成了江湖上永远的谜...谜...

与前两个问题相比，有关周泰的计算倒不复杂，也不涉及什么引理，只要用到概率论的基本知识就可以了。用s表示总牌数（此处取s=52×2=104），从濒死开始，An表示在第n次判定后仍然屹立不倒这一事件，Dn表示周泰死于第n次判定这一事件。我们有：

由An与Dn的关系得：

带入数据计算得到数值列表：

以及图像：

### 结论：周泰并不是那么硬嘛。周泰可能性最大的死亡时间是第5次判定，计算平均值得，周泰的平均死亡时间是5.43（以前相信的一种说法是7次）。终于知道周泰能活多久了。

讨论：

本文给出了有关RP型英雄的几个有启发意义的概率结果，其中甄姬和周泰的计算基本是精确的，而有关无中生有的讨论都是近似的，都没有考虑五谷丰登的影响，对于黄盖的计算还有很大的不确定程度。希望有牛人能够给出黄盖的更加合理的计算结果。